let currentDroppable = null;


function MouseDown(event) {
    let ruler = event.currentTarget.id.slice(0, 5);
    let shiftX = event.clientX - document.getElementById(event.currentTarget.id).getBoundingClientRect().left;
    let shiftY = event.clientY - document.getElementById(event.currentTarget.id).getBoundingClientRect().top;
    document.getElementById(event.currentTarget.id).style.position = 'absolute';
    document.getElementById(event.currentTarget.id).style.zIndex = 1000;
    document.getElementById(event.currentTarget.id).style.width = "100px";
    document.getElementById(event.currentTarget.id).style.height = "100px";
    if (ruler == "drg11") {
        document.getElementById(event.currentTarget.id).style.width = "200px";
        document.getElementById(event.currentTarget.id).style.height = "100px";
    }
    document.getElementById(event.currentTarget.id).style.border = "none ";
    const resize_none = document.getElementsByClassName('resizer');
    for (var i = 0; i < resize_none.length; i++) {
        resize_none[i].style.display = "none";
    }
    // moveAt(event.pageX, event.pageY);

    function move(pageX, pageY, Id) {

        document.getElementById(Id).style.left = pageX - shiftX + 'px';
        document.getElementById(Id).style.top = pageY - shiftY + 'px';
    }

    let Id = event.currentTarget.id;

    function onMouseMove(event) {

        move(event.pageX, event.pageY, Id);

    }

    document.addEventListener('mousemove', onMouseMove);
    var targetId = event.currentTarget.id;
    document.getElementById(targetId).onmouseup = function() {

        document.removeEventListener('mousemove', onMouseMove);
        var parent = document.getElementById('html-content-holder');

        parent.appendChild(document.getElementById(targetId));


        document.getElementById(targetId).onmouseup = null;

        let node = document.getElementById(targetId);
        let clone = node.cloneNode(true);
        let divId = targetId.slice(0, 5);

        let m = document.getElementById(divId + '_box');
        let n = m.getElementsByTagName('img');
        if (n.length == 0) {
            document.getElementById(divId + '_box').append(clone);
            $("#" + divId + "_box img").attr("style", " ");
            $("#" + divId + "_box img").attr("id", targetId + "e");
        }
        $("#html-content-holder #" + targetId).attr("onmousedown", "MouseDownElem(event)");
        $("#html-content-holder #" + targetId).attr("oncontextmenu", "ContextMenu(event)");
        $("#html-content-holder #" + targetId).attr("onclick", "del_elem(event)");
    };
    document.getElementById(event.currentTarget.id).ondragstart = function() {
        return false;
    };
};



function MouseDownElem(event) {
    let shiftX = event.clientX - document.getElementById(event.currentTarget.id).getBoundingClientRect().left;
    let shiftY = event.clientY - document.getElementById(event.currentTarget.id).getBoundingClientRect().top;
    document.getElementById(event.currentTarget.id).style.border = "none ";
    const resize_none = document.getElementsByClassName('resizer');
    for (var i = 0; i < resize_none.length; i++) {
        resize_none[i].style.display = "none";
    }
    // moveAt(event.pageX, event.pageY);

    function move(pageX, pageY, Id) {

        document.getElementById(Id).style.left = pageX - shiftX + 'px';
        document.getElementById(Id).style.top = pageY - shiftY + 'px';
    }

    let Id = event.currentTarget.id;

    function onMouseMove(event) {

        move(event.pageX, event.pageY, Id);

    }

    document.addEventListener('mousemove', onMouseMove);
    var targetId = event.currentTarget.id;
    document.getElementById(targetId).onmouseup = function() {

        document.removeEventListener('mousemove', onMouseMove);

        document.getElementById(targetId).onmouseup = null;
    };
    document.getElementById(event.currentTarget.id).ondragstart = function() {
        return false;
    };
};